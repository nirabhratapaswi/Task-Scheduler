{% load static %}
<div style="float: left">
	<a href="/taskscheduler/createtask">Create Task</a>
	<a href="/taskscheduler/tasklist">View Tasks</a>
	<a href="/taskscheduler/schedule">Schedule</a>
	<a href="/taskscheduler/createblocked">Create Blocked</a>
	<a href="/taskscheduler/blockedlist">View Blocked</a>
<div>
{% for b in blocked %}
	<h3>{{ b.name }}</h3>
	<ul>
		<li>id: {{ b.id }}</li>
		<li>Start Time: {{ b.start_time }}</li>
		<li>End Time: {{ b.end_time }}</li>
	</ul>
	<button  id="{{b.id}}" class="deleteBtn">Delete</button><br>
{% endfor %}


<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
{% block javascript %}
  <script>
  		function getCookie(name) {
             var cookieValue = null;
             if (document.cookie && document.cookie != '') {
                 var cookies = document.cookie.split(';');
                 for (var i = 0; i < cookies.length; i++) {
                     var cookie = jQuery.trim(cookies[i]);
                     // Does this cookie string begin with the name we want?
                     if (cookie.substring(0, name.length + 1) == (name + '=')) {
                         cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                         break;
                     }
                 }
             }
             return cookieValue;
         }
  		$(document).on("click",".deleteBtn", function () {
		    let id = $(this).attr('id');
		    $.ajax({
		        url: 'http://localhost:8000/tasksheduler/taskscheduler/deleteblocked',
		        contentType: "application/x-www-form-urlencoded",
		        type: "POST",
		        headers: {
		        	"X-CSRFToken": getCookie('csrftoken')
		        },
		        data: {
		          "id": id
		        },
		        dataType: 'json',
		        success: function (data) {
		          console.log("Blocked deleted successfully.");
		          location.reload();
		        }
		      });
		});
  </script>
{% endblock %}
